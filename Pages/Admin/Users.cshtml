@page
@model SaillingLoc.Pages.Admin.UsersModel
@{
    ViewData["Title"] = "Gestion des Utilisateurs";
}

<style>
    body {
        background-color: #f5f5f5;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    .header-section {
        background-color: white;
        padding: 20px;
        margin-bottom: 0;
        border-bottom: 1px solid #e0e0e0;
    }

    .header-section h4 {
        color: #5f6368;
        font-size: 20px;
        font-weight: 500;
        margin: 0 0 5px 0;
    }

    .header-section p {
        color: #80868b;
        font-size: 13px;
        margin: 0;
    }

    .btn-nouvel-utilisateur {
        background-color: #AD7C59;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        font-size: 14px;
        float: right;
        margin-top: -35px;
    }

    .btn-nouvel-utilisateur:hover {
        background-color: #c1926b;
        color: white;
    }

    .stats-container {
        display: flex;
        gap: 15px;
        background-color: white;
        padding: 20px;
        margin-bottom: 0;
    }

    .stat-card {
        flex: 1;
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
    }

    .stat-number {
        font-size: 32px;
        font-weight: 600;
        color: #202124;
        margin-bottom: 5px;
    }

    .stat-label {
        font-size: 13px;
        color: #5f6368;
        text-transform: capitalize;
    }

    .filters-section {
        background-color: white;
        padding: 20px;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        gap: 15px;
        align-items: center;
    }

    .search-input {
        flex: 1;
        max-width: 300px;
        padding: 8px 12px;
        border: 1px solid #dadce0;
        border-radius: 4px;
        font-size: 14px;
    }

    .search-input:focus {
        outline: none;
        border-color: #AD7C59;
    }

    .filter-select {
        padding: 8px 12px;
        border: 1px solid #dadce0;
        border-radius: 4px;
        font-size: 14px;
        background-color: white;
        min-width: 150px;
    }

    .table-container {
        background-color: white;
        padding: 0;
        overflow-x: auto;
    }

    .users-table {
        width: 100%;
        background-color: white;
        margin: 0;
        border-collapse: collapse;
    }

    .users-table thead {
        background-color: #fafafa;
        border-bottom: 1px solid #e0e0e0;
    }

    .users-table thead th {
        padding: 12px 16px;
        text-align: left;
        font-size: 12px;
        font-weight: 600;
        color: #5f6368;
        text-transform: uppercase;
        letter-spacing: 0.3px;
    }

    .users-table tbody tr {
        border-bottom: 1px solid #e0e0e0;
    }

    .users-table tbody tr:hover {
        background-color: #f8f9fa;
    }

    .users-table tbody td {
        padding: 16px;
        font-size: 14px;
        color: #202124;
        vertical-align: middle;
    }

    .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background-color: #AD7C59;
        color: white;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
        font-size: 13px;
        margin-right: 12px;
        vertical-align: middle;
    }

    .user-name {
        font-weight: 500;
        color: #202124;
    }

    .user-contact {
        font-size: 13px;
        color: #5f6368;
    }

    .role-badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
        margin-right: 5px;
    }

    .badge-locataire {
        background-color: #e3f2fd;
        color: #1976d2;
    }

    .badge-proprietaire {
        background-color: #fff3e0;
        color: #f57c00;
    }

    .badge-admin {
        background-color: #fce4ec;
        color: #c2185b;
    }

    .status-actif {
        color: #34a853;
        font-size: 13px;
        font-weight: 500;
    }

    .status-actif::before {
        content: "‚úì";
        margin-right: 5px;
    }

    .action-icons {
        display: flex;
        gap: 8px;
    }

    .icon-btn {
        background: none;
        border: none;
        cursor: pointer;
        padding: 6px;
        border-radius: 4px;
        color: #5f6368;
        font-size: 18px;
    }

    .icon-btn:hover {
        background-color: #f1f3f4;
    }

    .icon-btn.delete {
        color: #d32f2f;
    }

    .checkbox-cell {
        width: 40px;
    }

    .checkbox-cell input[type="checkbox"] {
        width: 16px;
        height: 16px;
        cursor: pointer;
    }
</style>

<div class="header-section">
    <h4>Gestion des Utilisateurs</h4>
    <p>G√©rez tous les utilisateurs de la plateforme</p>
    <button class="btn-nouvel-utilisateur">+ Nouvel utilisateur</button>
</div>

<div class="stats-container">
    <div class="stat-card">
        <div class="stat-number">@Model.TotalUsers</div>
        <div class="stat-label">Total</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">@Model.ActiveUsers</div>
        <div class="stat-label">Actifs</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">@Model.InactiveUsers</div>
        <div class="stat-label">Inactifs</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">@Model.TenantCount</div>
        <div class="stat-label">Locataires</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">@Model.OwnerCount</div>
        <div class="stat-label">Propri√©taires</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">@Model.AdminCount</div>
        <div class="stat-label">Administrateurs</div>
    </div>
</div>

<div class="filters-section">
    <input type="text" class="search-input" placeholder="üîç Rechercher un utilisateur..." name="searchTerm" value="@Model.SearchTerm" />
    <select class="filter-select" name="roleFilter">
        <option value="">Tous les r√¥les</option>
        <option value="locataire">Locataire</option>
        <option value="proprietaire">Propri√©taire</option>
        <option value="admin">Administrateur</option>
    </select>
    <select class="filter-select" name="statusFilter">
        <option value="actif">Actif</option>
        <option value="inactif">Inactif</option>
        <option value="tous">Tous</option>
    </select>
</div>

<div class="table-container">
    <table class="users-table">
        <thead>
            <tr>
                <th class="checkbox-cell"><input type="checkbox" /></th>
                <th>UTILISATEUR</th>
                <th>CONTACT</th>
                <th>R√îLE</th>
                <th>STATUT</th>
                <th>DATE DE CR√âATION</th>
                <th>ACTIONS</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var user in Model.Users)
            {
                <tr>
                    <td class="checkbox-cell"><input type="checkbox" /></td>
                    <td>
                        <span class="user-avatar">
                            @(string.IsNullOrEmpty(user.FirstName) ? "" : user.FirstName.Substring(0, 1))@(string.IsNullOrEmpty(user.LastName) ? "" : user.LastName.Substring(0, 1))
                        </span>
                        <span class="user-name">@user.FullName</span>
                    </td>
                    <td>
                        <div class="user-contact">@user.Email</div>
                        <div class="user-contact">@user.PhoneNumber</div>
                    </td>
                    <td>
                        @if (user.Roles != null && user.Roles.Any())
                        {
                            @foreach (var role in user.Roles)
                            {
                                var badgeClass = role.ToLower() switch
                                {
                                    "locataire" => "badge-locataire",
                                    "proprietaire" or "propri√©taire" => "badge-proprietaire",
                                    "admin" or "administrateur" => "badge-admin",
                                    _ => "badge-locataire"
                                };
                                <span class="role-badge @badgeClass">@role</span>
                            }
                        }
                        else
                        {
                            <span class="role-badge badge-locataire">Locataire</span>
                        }
                    </td>
                    <td>
                        <span class="status-actif">Actif</span>
                    </td>
                    <td>@user.CreatedAt.ToString("dd/MM/yyyy")</td>
                    <td>
                        <div class="action-icons">
                            <button class="icon-btn" title="Voir">üëÅ</button>
                            <button class="icon-btn" title="Modifier">‚úèÔ∏è</button>
                            <button class="icon-btn delete" title="Supprimer">üóë</button>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>